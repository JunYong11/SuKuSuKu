<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">

<title>Components / Cards - NiceAdmin Bootstrap Template</title>
<meta content="" name="description">
<meta content="" name="keywords">

<!-- Favicons -->
<link href="/assets/img/favicon.png" rel="icon">
<link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

<!-- Google Fonts -->
<link href="https://fonts.g.assets.com" rel="preconnect">
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
	rel="stylesheet">

<!-- Vendor CSS Files -->
<link href="/assets/vendor/bootstrap/css/bootstrap.min.css"
	rel="stylesheet">
<link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css"
	rel="stylesheet">
<link href="/assets/vendor/boxicons/css/boxicons.min.css"
	rel="stylesheet">
<link href="/assets/vendor/quill/quill.snow.css" rel="stylesheet">
<link href="/assets/vendor/quill/quill.bubble.css" rel="stylesheet">
<link href="/assets/vendor/remixicon/remixicon.css" rel="stylesheet">
<link href="/assets/vendor/simple-datatables/style.css" rel="stylesheet">

<!-- Template Main CSS File -->
<link href="/assets/css/style.css" rel="stylesheet">

<!--   -->
<link
	href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css'
	rel='stylesheet' />
<script
	src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
<script
	src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/ko.js'></script>
<style>
#calendar {
	width: 100%;
	max-width: 300px; /* 프로필 카드와 비슷한 크기로 설정 */
	height: 300px; /* 위젯처럼 작은 크기 */
	font-size: 0.8rem;
}

#calendarModal .modal-dialog {
	max-width: 1000px; /* 원하는 크기로 조정 */
	width: 90%; /* 반응형 조절 */
}

#calendarModal .modal-content {
	height: 800px; /* 원하는 높이 */
	overflow-y: auto; /* 내용이 넘칠 경우 스크롤 추가 */
}

.form-control {
	margin-bottom: 10px;
}
.group-container {
    display: flex;
    align-items: center;
    flex-wrap: wrap; /* 자동 줄바꿈 */
    gap: 10px;
    margin-top: 10px;
    position: relative; /* 입력창 위치 조정을 위해 필요 */
  }

  .group-box {
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 14px;
    display: flex;
    align-items: center;
    font-weight: bold; /* 글자 볼드 처리 */
  }

  /* 입력창을 + 버튼 아래에 위치 */
  .popup {
    display: none;
    position: absolute;
    top: 40px; /* + 버튼 아래에 위치 */
    left: 0;
    background: white;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-shadow: 0px 2px 5px rgba(0,0,0,0.2);
    white-space: nowrap; /* 가로 너비 유지 */
  }
</style>
</head>

<body>

	<div th:replace="~{header.html}"></div>
	<div th:replace="~{sidebar.html}"></div>

	<!-- ========================= 수정 시작 =================================-->
	<main id="main" class="main">

		<div class="pagetitle">
			<h1>Profile</h1>
			<nav>
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="index.html">Home</a></li>
					<li class="breadcrumb-item">Users</li>
					<li class="breadcrumb-item active">Profile</li>
				</ol>
			</nav>
		</div>
		<!-- End Page Title -->

		<section class="section profile">
			<div class="row">
				<div class="col-xl-3">
					<div class="card">
						<div
							class="card-body profile-card pt-4 d-flex flex-column align-items-center">

							<img src="assets/img/profile-img.jpg" alt="Profile"
								class="rounded-circle">
							<h2>Kevin Anderson</h2>
							<h3>Web Designer</h3>
							<div class="social-links mt-2">
								<a href="#" class="twitter"><i class="bi bi-twitter"></i></a> <a
									href="#" class="facebook"><i class="bi bi-facebook"></i></a> <a
									href="#" class="instagram"><i class="bi bi-instagram"></i></a>
								<a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
							</div>
							<div id='calendar' onclick="openCalendarModal()"></div>
						</div>
					</div>
				</div>

				<!-- 추가 위젯 (오른쪽) -->
				<div class="col-xl-8">
					<div class="card">
						<div class="card-body">
							<h5 class="card-title" style="font-size: 20px; margin: 0;">Project</h5>
							<div style="border-bottom: 1px solid black; width: 100%;"></div>

							<!-- 그룹 추가되는 부분 -->
							<div class="group-container" id="groupContainer">
								<button id="addGroupBtn"
									style="border: none; background: none; font-size: 22px; cursor: pointer;">+</button>
							</div>

							<!-- 입력창 (초기에는 숨김) -->
							<div id="popup" class="popup">
								<input type="text" id="groupInput" placeholder="그룹명을 입력하세요" />
								<button id="confirmAddBtn">추가</button>
							</div>

							<p>여기에 새로운 기능을 추가하세요.</p>
							             
							<div id="extra-widget">
								<div>dkdkdkdkdkdkdk</div>

							</div>
						</div>
					</div>
				</div>

<script>
  const addGroupBtn = document.getElementById("addGroupBtn");
  const popup = document.getElementById("popup");
  const confirmAddBtn = document.getElementById("confirmAddBtn");
  const groupInput = document.getElementById("groupInput");
  const groupContainer = document.getElementById("groupContainer");

  // 순서대로 변경될 색상 배열
  const colors = ["#007bff", "#6c757d", "#343a40", "#28a745", "#ffc107", "#dc3545"];
  let colorIndex = 0;

  // + 버튼 클릭 시 입력창 표시 (위치 동기화)
  addGroupBtn.addEventListener("click", () => {
    popup.style.display = "block";
    updatePopupPosition();
  });

  // 그룹 추가 버튼 클릭 시
  confirmAddBtn.addEventListener("click", () => {
    const groupName = groupInput.value.trim();
    if (groupName === "") return; // 빈 값 방지

    // 새로운 그룹 박스 생성
    const groupBox = document.createElement("div");
    groupBox.classList.add("group-box");
    groupBox.textContent = groupName;

    // 색상 순서대로 적용
    groupBox.style.background = colors[colorIndex];
    groupBox.style.color = "white"; // 글자색 흰색 유지

    // 다음 색상으로 변경 (배열을 순환하도록 설정)
    colorIndex = (colorIndex + 1) % colors.length;

    // 그룹을 추가하고 버튼을 오른쪽으로 밀어냄
    groupContainer.insertBefore(groupBox, addGroupBtn);

    // 입력창 위치 업데이트
    updatePopupPosition();

    // 입력창 초기화 및 숨김
    groupInput.value = "";
  });

  // 입력창 위치 업데이트 함수
  function updatePopupPosition() {
    popup.style.left = `${addGroupBtn.offsetLeft}px`; // + 버튼 위치에 맞춰 이동
  }

  // 창 크기 변경 시 입력창 위치 업데이트
  window.addEventListener("resize", updatePopupPosition);
</script>
			</div>
			<div class="col-xl-8">
					<div class="card">
						<div class="card-body">
							<h5 class="card-title" style="font-size: 20px; margin: 0;">Project</h5>
							<div style="border-bottom: 1px solid black; width: 100%;"></div>

							<!-- 그룹 추가되는 부분 -->
							<div class="group-container" id="groupContainer">
								<button id="addGroupBtn"
									style="border: none; background: none; font-size: 22px; cursor: pointer;">+</button>
							</div>

							<!-- 입력창 (초기에는 숨김) -->
							<div id="popup" class="popup">
								<input type="text" id="groupInput" placeholder="그룹명을 입력하세요" />
								<button id="confirmAddBtn">추가</button>
							</div>

							<p>여기에 새로운 기능을 추가하세요.</p>
							             
							<div id="extra-widget">
								<div>dkdkdkdkdkdkdk</div>

							</div>
						</div>
					</div>
				</div>
		</section>
	</main>

	<!-- End #main -->

	<!-- ========================================== modal ============================================ -->

	<!-- 캘린더 모달 -->
	<div class="modal fade" id="calendarModal" tabindex="-1"
		aria-labelledby="calendarModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="calendarModalLabel">전체 캘린더</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div id="fullCalendar" onclick="insertCalendarModal()"></div>
					<!-- 전체 캘린더 표시 -->
				</div>
			</div>
		</div>
	</div>

	<!-- 일정 입력 모달 -->
	<div class="modal fade" id="eventModal" tabindex="-1"
		aria-labelledby="eventModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="eventModalLabel">새 일정 추가</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<p>
						<strong>선택한 날짜:</strong> <span id="selectedDate"></span>
					</p>
					<input type="hidden" id="selectedDateInput"> <input
						type="text" id="schedule" class="form-control" placeholder="일정">
					<input type="text" id="memo" class="form-control" placeholder="메모">
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">닫기</button>
					<button type="button" class="btn btn-primary" id="saveEvent">저장</button>
				</div>
			</div>
		</div>
	</div>


	<div th:replace="~{footer.html}"></div>

	<!--  script -->
	<script>
		document.addEventListener('DOMContentLoaded', function() {

			var calendarEl = document.getElementById('calendar');
			var calendar = new FullCalendar.Calendar(calendarEl, {
				expandRows : true, // 화면에 맞게 높이 재설정
				slotMinTime : '08:00', // Day 캘린더에서 시작 시간
				slotMaxTime : '20:00', // Day 캘린더에서 종료 시간

				headerToolbar : {
					left : 'prev,next',
					center : 'title',
					right : 'dayGridMonth'
				},

				initialView : 'dayGridMonth',
				editable : true,
				selectable : true, // 달력 일자 드래그 설정가능
				nowIndicator : true, // 현재 시간 마크
				dayMaxEvents : true, // 이벤트가 오버되면 높이 제한 (+ 몇 개식으로 표현)
				locale : 'ko', // 한국어 설정
			});

			calendar.render();

			function openCalendarModal() {
				var calendarModal = new bootstrap.Modal(document
						.getElementById('calendarModal'));
				calendarModal.show();
			}

			function insertCalendarModal() {
				var calendarModal = new bootstrap.Modal(document
						.getElementById('eventModal'));
				calendarModal.show();
			}

			window.openCalendarModal = openCalendarModal;
		});
	</script>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			var fullCalendarEl = document
				.getElementById('fullCalendar');
			var fullCalendar = new FullCalendar.Calendar( fullCalendarEl, {
				expandRows : true, // 화면에 맞게 높이 재설정
				slotMinTime : '08:00', // Day 캘린더에서 시작 시간
				slotMaxTime : '20:00', // Day 캘린더에서 종료 시간

				headerToolbar : {
					left : 'prev,next',
					center : 'title',
					right : 'dayGridMonth'
				},

				initialView : 'dayGridMonth',
				editable : true,
				selectable : true, // 달력 일자 드래그 설정가능
				nowIndicator : true, // 현재 시간 마크
				dayMaxEvents : true, // 이벤트가 오버되면 높이 제한 (+ 몇 개식으로 표현)
				locale : 'ko', // 한국어 설정

				select : function(info) {
					let selectedDate = info.startStr;
					document.getElementById('selectedDate').innerText = selectedDate;
					document.getElementById('selectedDateInput').value = selectedDate;
					let eventModal = new bootstrap.Modal(
					document.getElementById('eventModal'));
					eventModal.show();
				}
			});

			function openCalendarModal() {
				var calendarModal = new bootstrap.Modal(
					document.getElementById('calendarModal'));
					calendarModal.show();
				}

				document.getElementById('calendarModal')
					.addEventListener('shown.bs.modal', function() {
						fullCalendar.render(); // 모달이 완전히 열린 후 렌더링
			});

			window.openCalendarModal = openCalendarModal;
			});
	</script>

	<script>
	document.getElementById('saveEvent').addEventListener('click', function() {
	    let formData = {
	        selectDate: document.getElementById('selectedDateInput').value,
	        schedule: document.getElementById('schedule').value,
	        memo: document.getElementById('memo').value
	    };

	    fetch('/users/register', {
	        method: 'POST',
	        headers: {
	            'Content-Type': 'application/json'
	        },
	        body: JSON.stringify(formData)
	    })
    	.then(response => response.text()) // 문자열 응답 처리
    	.then(data => {
        	console.log('Success:', data);

	        // 모달창 닫기
	        let eventModal = bootstrap.Modal.getInstance(document.getElementById('eventModal'));
	        eventModal.hide();

	        // 캘린더 새로고침
	        calendar.refetchEvents();
	    })
	    .catch(error => {
	        console.error('Error:', error);
	    });
	});

	
	</script>


	<a href="#"
		class="back-to-top d-flex align-items-center justify-content-center"><i
		class="bi bi-arrow-up-short"></i></a>

	<!-- Vendor JS Files -->
	<script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
	<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="/assets/vendor/chart.js/chart.umd.js"></script>
	<script src="/assets/vendor/echarts/echarts.min.js"></script>
	<script src="/assets/vendor/quill/quill.js"></script>
	<script src="/assets/vendor/simple-datatables/simple-datatables.js"></script>
	<script src="/assets/vendor/tinymce/tinymce.min.js"></script>
	<script src="/assets/vendor/php-email-form/validate.js"></script>

	<!-- Template Main JS File -->
	<script src="/assets/js/main.js"></script>



</body>
</html>
